<!DOCTYPE html>

<html>
<head>
	<meta charset="utf-8" />
	<title>GeoTracert via leaflet</title>
	<!-- Добавляем файлы стилей CSS для библиотеки -->
	<link rel="stylesheet" href="style/leaflet.css" />
	<link rel="stylesheet" href="style/style.css" />
	<!--[if lte IE 8]>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
	<![endif]-->

	<!-- Добавляем ссылку на JS-скрипт библиотеки -->
	<script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
	<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script src="http://api-maps.yandex.ru/2.0/?load=package.map&lang=ru-RU" type="text/javascript"></script>
	<script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
	
	<script src="layer/Google.js"></script>	
	<script src="layer/Yandex.js"></script>
	<script src="list/iplist.js"></script>
        <script src="ForListener.js"></script>
	<script src="ForListener.js"></script>
	<script src="Clientjws.js"></script>
</head>









<script type="text/javascript" src="<path_to_jWebSocket.js>/jwebsocket.js"></script>








<script type="text/javascript">
	window.onload=function(){

		//Определяем карту, координаты центра и начальный масштаб
		var map = L.map('map').setView(myPoints[0].coords, 18);
		
		var mypol = new Array(myPoints.length);	//массив координат

		for(var i = 0; i < myPoints.length; i++){
			mypol[i] = myPoints[i].coords
			L.marker(myPoints[i].coords).addTo(map)
				.bindPopup(myPoints[i].text)
		};
		
		// ломаная между точками
		var polyline = L.polyline(mypol,
		{color: 'blue',							//цвет
		weight: 5,								//толщина
		opacity: 0.9,							//мутность
		smoothFactor: 1})
			.addTo(map);

		// в фокусе все метки
		//map.fitBounds(polyline.getBounds());			
		
		var osm = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
		var cldmd = new L.tileLayer('http://{s}.tile.cloudmade.com/56eded06210846ecbb758f29e7c28152/997/256/{z}/{x}/{y}.png', {
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
			maxZoom: 18 });
		// Possible types: map, satellite, hybrid, publicMap, publicMapHybrid
		var yndx = new L.Yandex();
		// Possible types: SATELLITE, ROADMAP, HYBRID, TERRAIN
		var googleRoadMap = new L.Google('ROADMAP');
		
		map.addLayer(osm);

		map.addControl(new L.Control.Layers({'OSM':osm, 'CloudMade':cldmd, 'Yandex':yndx, 'Google-дорожная карта':googleRoadMap}));
		
		document.getElementById('SearchButton').onclick = verify;

		function verify(){		//Валидация введённого значения

			var valid = /^(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[0-9]{2}|[0-9])(\.(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[0-9]{2}|[0-9])){3}$/;
			var textbox = document.getElementById('InputBox');
			// Для поиска отправляется запрос.
			if(textbox.value == ""){
				alert('Введите данные в поле!');
			}
			else if(!valid.test(textbox.value)){
				alert('Неверно введен IP');
			}
			else {
				alert('В этот момент должен отправляться запрос на сервер');	
			}
			textbox.value = "";
			textbox.focus();
		}
		
		var textbox1 = document.getElementById('InputBox');

	}
</script>

<body>
	<div align="center">
		<h1>GeoTracert template</h1>
		<div id="frame">
          <div id="map"> </div>
		</div>
		<h4>&nbsp</h4>
		<input type="text" style="text-align: left" id="InputBox" placeholder="Введите IP для поиска" size="21" value=""/>
		<input type="button" id="SearchButton" value="Пуск"/>
	</div>
</body>

</html>